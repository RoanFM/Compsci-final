---
title: "Pizza Party"
author: "Xi Feng, Charles Zhang, Jinghan Zhou, Roan Floer-Martinez "
output: 
  html_document:
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
```

```{r message=FALSE}
library(sf) 
library(leaflet)
library(RColorBrewer)
library(plotly)
library(skimr) 
library(shiny)
library(readr)
library(tidyverse)
library(lubridate)
library(gplots) 
library(ggmap)
library(naniar) 
library(formattable)
```

```{r}
# Read Data
pizza_datafiniti <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-01/pizza_datafiniti.csv") %>% 
  unique()
pizza_jared <- readr::read_csv("https://raw.githubusercontent.com/RoanFM/Compsci-final/master/Data/pizza_jared.csv") %>% 
  unique() 
pizza_barstool <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-01/pizza_barstool.csv") %>% 
  unique()
```

### **Introduction**

#### Our goal is to help people find the best pizza in New York, depending on their location in the city, price range, and kind of pizzeria they are looking for. To do this, we used three datasets from the TidyTuesday Pizza Party set. We used a dataset from DataFiniti which provides use with geographic data of over 10000 pizza places. 

```{r}
leaflet(data=pizza_datafiniti) %>% 
  addProviderTiles(providers$Esri.NatGeoWorldMap) %>% 
  addCircleMarkers(lng = ~longitude, lat = ~latitude, color = "red", label=~name,stroke = FALSE, fillOpacity = 0.5, radius = 2)
```

### As this dataset shows that New York city has the most pizza(not include Brokklyn), using pizzateria places in New York City in our research will be meaningful and representative.

```{r}
pizza_datafiniti %>% 
  group_by(city) %>% 
  summarise(n = n()) %>%
  mutate(city = fct_reorder(city, n)) %>% 
  arrange(desc(n)) %>% 
  head(10) %>% 
  ggplot(aes(x=city, y=n,fill=city))+
  geom_col()+
  coord_flip()+
  theme_minimal()+
  theme(legend.position="none")+
  ylab("Number of Pizza Places")+
  labs(title = "Top 10 Cities for Pizza")
```

#### We then crossed this against two datasets which included ratings, one by Jared Lander which has ratings from New York locals, and one from the Barstool Sports magazines which covers pizzerias across the nation but only has ratings from Barstool employees. 

#### Next, we compared the average review socres among NYC, Brooklyn, Boston, and Minneapolis, places that are known for pizza in the Barstool's dataset. 

```{r, results='hide'}
pizza_barstool %>% 
  filter(city == c("New York", "Brooklyn", "Chicago", "Boston")) %>% 
  ggplot(aes(x=review_stats_all_average_score))+
  geom_histogram(aes(fill = city))+
  theme_minimal()+
  facet_wrap(~city)+
  theme(legend.position="none")+
  labs(title = "Average Rating Scores")+
  xlim(0,10)+
  xlab("Average Review Rating Score")
```

#### This plot implies that we have more significant distrubution for the average rating socre in New York. This is also the reason why we choose to use pizzeria in NYC. 


### **Analysis**

#### We have different methods for pizza ratings, so we would like to analyze the differences similarities between each mathed first. 

```{r, results='hide'}
pizza_barstool %>% 
  mutate(community = review_stats_community_average_score, all = review_stats_all_average_score, dave = review_stats_dave_average_score) %>% 
  select(name, all, community, dave) %>% 
  pivot_longer(cols = -name, names_to = "category", values_to = "score") %>% 
  ggplot(aes(x=score))+
  geom_histogram(aes(fill=category), alpha = 0.4)+
  geom_density(aes(y=..density..*count, color = category), position='dodge', alpha = 0, size= 1)+
  theme_minimal()+
  facet_wrap(~category)+
  theme(legend.position="none")+
  labs(title = "Average Rating Scores")
```

#### Overall, the average scores distributions of all reviews, the community rating, and the Dave rating are similar but still exist differences.










