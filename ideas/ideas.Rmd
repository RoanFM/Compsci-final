---
title: "ideas"
author: "Charles Zhang, Roan Floer-Martinez, Jinghan Zhou, Xi Feng"
output: 
  html_document:
    keep_md: yes
# runtime: shiny
---
```{r message=FALSE}
library(readr)
library(tidyverse)
library(lubridate)
library(skimr) 
library(naniar) 
library(ggmap)
library(gplots) 
library(RColorBrewer) 
library(sf) 
library(leaflet)
library(formattable)
library(shiny)
```

## Dataset 1: Board Games

```{r message=FALSE, warning=FALSE}
board_games <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-03-12/board_games.csv")
```
```{r}
board_games %>%
  group_by(year_published) %>% 
  summarise(num_published = n()) %>% 
  ggplot(aes(x=year_published, y=num_published))+
  geom_line()+
  theme_classic()
```

> Shiny App

```{r, echo=FALSE}
# shinyApp(
# ui <- fluidPage(
#   sliderInput(inputId = "year", label = "Year Published",
#               min = 1950, max = 2019, value = c(1950,2019),sep = ""),
#   textInput("max_players", "Max Players", value = "", placeholder = "1"),
#   selectInput("minage", "Min age", choices = board_games$min_age),
#   submitButton(text = "Create my plot!"),
#   plotOutput(outputId = "timeplot")),
# 
# server <- function(input, output) {
#   output$timeplot <- renderPlot({
#     board_games %>% 
#       arrange(min_age) %>% 
#       filter(max_players == input$max_players, min_age == input$minage) %>% 
#       ggplot(aes(x = year_published, y = average_rating, color=min_playtime, label = name))+
#       geom_point()+
#       geom_text()+
#       scale_x_continuous(limits = input$year) +
#       theme_classic()
#   })
# },
# options = list(height=750)
# )
```


## Dataset 2: Video Games
> *Data:* 
https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-07-30
This dataset seems pretty interesting and straightforward

```{r message=FALSE}
library(readr)
video_games <- read_csv("~/Desktop/Compsci-final/ideas/video_games.csv")

video_games[video_games==0] <- NA
vg_clean<-video_games %>% 
  drop_na() 
```

> **Ideas:**
find out the popularity/trend of Video games and compare the different video games companies by those variables in the data.

> **Graphs/Tables:**

```{r message=FALSE}
vg_clean %>% 
  ggplot(aes(x = price))+
  geom_density() +
  theme_classic()

top_20_avrplaytime_game <- vg_clean %>% 
  select(game, average_playtime, price, owners) %>% 
  arrange(desc(average_playtime)) %>% 
  head(20)

top_20_avrplaytime_game %>% 
  ggplot(aes(x=price, y=average_playtime,label=game, color = owners))+
  geom_point()+
  geom_text(family="STKaiti")+
  theme_classic()
```

> This graph shows the relation between pices of games, average play times of games, and the number of owners of games with top 20 average playtime


## Dataset 3: Pizza Party

> **Data:**

```{r message=FALSE, warning=FALSE}
# Read Data
pizza_jared <- readr::read_csv("https://raw.githubusercontent.com/RoanFM/Compsci-final/master/ideas/pizza_jared.csv")
pizza_barstool <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-01/pizza_barstool.csv")
pizza_datafiniti <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-01/pizza_datafiniti.csv")
```

> **Graphs/Tables**

> Pizza in the U.S.

```{r message=FALSE, warning=FALSE}
leaflet(data=pizza_datafiniti) %>% 
  addProviderTiles(providers$Esri.NatGeoWorldMap) %>% 
  addCircleMarkers(lng = ~longitude, lat = ~latitude, color = "red", label=~name,stroke = FALSE, fillOpacity = 0.5, radius = 2)
```

```{r message=FALSE, warning=FALSE}
mn_pizza <- pizza_datafiniti %>% 
  filter(province == "MN")
```

> Pizza in the Minnesota

```{r message=FALSE, warning=FALSE}
leaflet(data=mn_pizza) %>% 
  addProviderTiles(providers$Stamen.Toner) %>% 
  addMarkers(lng = ~longitude, lat = ~latitude, label = ~name,clusterOptions = markerClusterOptions())

```

```{r message=FALSE, warning=FALSE}
# sum the total votes and rate
pizza_excerllent <- pizza_jared %>% 
  filter(answer=="Excellent") %>% 
  group_by(place) %>% 
  mutate(sum_votes=sum(votes), sum_total=sum(total_votes)) %>% 
  mutate(p = sum_votes/sum_total)

pizza_good <- pizza_jared %>% 
  filter(answer=="Good") %>% 
  group_by(place) %>% 
  mutate(sum_votes=sum(votes), sum_total=sum(total_votes)) %>% 
  mutate(p = sum_votes/sum_total)

pizza_average <- pizza_jared %>% 
  filter(answer=="Average") %>% 
  group_by(place) %>% 
  mutate(sum_votes=sum(votes), sum_total=sum(total_votes)) %>% 
  mutate(p = sum_votes/sum_total)

pizza_poor <- pizza_jared %>% 
  filter(answer=="Poor") %>% 
  group_by(place) %>% 
  mutate(sum_votes=sum(votes), sum_total=sum(total_votes)) %>% 
  mutate(p = sum_votes/sum_total)

pizza_never <- pizza_jared %>% 
  filter(answer=="Never Again") %>% 
  group_by(place) %>% 
  mutate(sum_votes=sum(votes), sum_total=sum(total_votes)) %>% 
  mutate(p = sum_votes/sum_total)

# create pizza rating data frame
pizza_rating <- rbind(pizza_excerllent, pizza_good, pizza_average, pizza_poor, pizza_never) %>% 
  mutate(date = as_datetime(time)) %>% 
  mutate(year=year(date)) %>% 
  group_by(place, year, answer) %>% 
  mutate(year_avr_rate = mean(p))
```
```{r}
# Top ten highest Excerllent rate 
top_ten_excerllent<-pizza_rating %>% 
  filter(answer=="Excellent") %>% 
  group_by(place) %>% 
  summarise(rate = sum(p)/n()) %>% 
  arrange(desc(rate)) %>% 
  head(10) 

# Graph
top_ten_excerllent %>% 
  inner_join(pizza_rating, by="place") %>% 
  ggplot(aes(x=answer, y=percent, fill=place))+
  geom_bar(stat='identity',position='dodge')+
  theme_classic()
```






